{
  "project_metadata": {
    "name": "DeploySentinel - Extensão para gravação, automação e replay de testes UI em navegadores (Web/Mobile/Desktop) com integração Cypress",
    "domain": [
      "Web/Mobile/Desktop Automation",
      "Browser Extension",
      "UI Test Automation",
      "Frontend Development",
      "End-to-End Testing",
      "Recording and Replay",
      "Quality Assurance",
      "DevOps",
      "Software Development",
      "User Session Recording",
      "Web Application Testing",
      "Component-based Architecture",
      "Dark Theme UI",
      "Data Integrity",
      "Enterprise Data Management"
    ],
    "current_phase": [
      "Development",
      "Production",
      "Active Maintenance",
      "Stable with incremental improvements",
      "MVP",
      "Testing and Validation"
    ],
    "critical_business_rules": [
      "Preserve fast refresh functionality",
      "Ensure JSX transpilation compatibility",
      "Build must generate consistent artifacts",
      "Do not break deploy pipeline",
      "Accurate and complete user event capture",
      "Correct and readable script generation",
      "Compatibility with multiple test frameworks",
      "Isolated test environment required",
      "Consistent configuration for CI/CD",
      "Automatically generate valid Cypress scripts",
      "Support for multiple browsers and manifest versions",
      "Code integrity and quality assurance",
      "Accurate recording of user interactions",
      "Generate scripts compatible with Cypress, Playwright, and Puppeteer",
      "Browser permission security",
      "Data privacy and user anonymity",
      "Secure integration with authorized domains",
      "State synchronization across tabs and components",
      "No loss of navigation events during active recording",
      "Replay commands only with valid sessions",
      "Isolate between tabs and frames during recording",
      "Strict message origin validation",
      "Secure communication between webapp and extension",
      "Consistent visual branding and iconography",
      "React 18+ compatibility",
      "SVG rendering correctness",
      "Performance and responsiveness in rendering",
      "Only supported action types should be rendered",
      "Sensitive input values must be masked",
      "Unique and stable selectors for test actions",
      "Accessibility compliance",
      "Responsive layout support",
      "Consistent dark mode application",
      "Persistent user preferences",
      "Consistent UI layout",
      "Consistent data integrity during import/export",
      "Unique ID generation for recordings",
      "All actions must have valid, non-negative, and sequential timestamps",
      "No empty or invalid recordings should be saved",
      "Error logging without interrupting flow",
      "Build must run in production mode",
      "NODE_ENV must always be defined",
      "Do not expose secrets in final bundle",
      "Consistent visual feedback on interactive elements",
      "Consistent state synchronization between replay and UI",
      "No replay execution with empty recordings",
      "Consistent accessibility and usability",
      "Confirmation required before deletion",
      "Consistent error and loading state feedback",
      "Consistent dark theme visual identity",
      "Consistent transactional integrity",
      "Role-based access control",
      "All recordings must have urlOriginal for traceability",
      "No multiple migrations to avoid inconsistencies",
      "Consistent execution log association with recordings",
      "Debounce to avoid excessive simultaneous writes",
      "Consistent pruning strategy for storage limits",
      "Consistent navigation state between UI and URL hash",
      "Consistent error highlighting for quick identification",
      "Consistent feedback for user actions",
      "Consistent accessibility for color contrast",
      "Consistent visual state across themes",
      "Consistent file naming for exports",
      "Consistent validation of base64 images before display",
      "Consistent error handling for screenshots",
      "Consistent pruning of screenshots to avoid storage quota overflow",
      "Consistent error handling for execution not found and storage quota errors"
    ]
  },
  "technical_stack": {
    "primary_language": [
      "TypeScript 5.x",
      "JavaScript ES2022",
      "React 18.x",
      "Node.js 18",
      "CSS3",
      "JSON"
    ],
    "frameworks": [
      "React 18.x",
      "Webpack 5",
      "Babel",
      "Cypress 12.x",
      "Playwright 1.x",
      "Puppeteer",
      "Jest 29.x",
      "React Testing Library",
      "@tanstack/react-table 8.21.3",
      "Chrome Extensions Manifest V3",
      "WebExtensions API",
      "Lodash 4.x",
      "FontAwesome 6.x"
    ],
    "databases": [
      "chrome.storage.local",
      "IndexedDB (via RecordingService)",
      "LocalStorage (browser)",
      "MongoDB 6.0"
    ],
    "external_services": [
      "Chrome Web Store",
      "Firefox Add-ons Marketplace",
      "GitHub Actions",
      "Browser APIs (chrome.*)",
      "DeploySentinel Webapp",
      "Google Analytics Measurement Protocol API",
      "Cypress Test Runner",
      "Replay backend services",
      "Font icon libraries (FontAwesome)",
      "REST APIs for authentication and notifications"
    ],
    "package_manager": ["npm", "yarn"]
  },
  "architecture_patterns": {
    "design_pattern": [
      "Modular Architecture",
      "Event-driven Architecture",
      "Component-based React",
      "Observer Pattern",
      "Singleton",
      "Builder Pattern",
      "Factory Method",
      "Command Pattern",
      "Repository Pattern",
      "Facade Pattern",
      "Service Layer Abstraction",
      "Separation of Concerns",
      "Functional Components with Hooks",
      "Virtual Scrolling Pattern",
      "Debounce for async write optimization",
      "Atomic Design",
      "Theming with CSS Variables"
    ],
    "folder_structure": [
      "src/",
      "src/components",
      "src/hooks",
      "src/utils",
      "src/types",
      "src/builders",
      "src/services",
      "src/store",
      "src/replay",
      "src/assets",
      "src/styles",
      "src/config",
      "tests/",
      "dist/",
      "build/",
      "node_modules/"
    ],
    "naming_conventions": [
      "camelCase for variables and functions",
      "PascalCase for React components and classes",
      "kebab-case for files and CSS classes",
      "UPPER_SNAKE_CASE for constants and enums",
      "snake_case for static assets",
      "Prefix 'use' for custom hooks",
      "BEM-like for CSS classes",
      "Descriptive names for scripts and files"
    ],
    "module_boundaries": [
      "Separation between config and source code",
      "Clear separation between background scripts, content scripts, and UI (popup)",
      "Utils for stateless helper functions",
      "Storage for persistence and migration",
      "Replay for session and command control",
      "Config for loading and accessing settings",
      "Component isolation with explicit props",
      "Hooks for encapsulating state and reusable logic",
      "Service modules for external integrations",
      "Types centralized in types folder",
      "Separation between UI (components) and business logic (builders, recorder)",
      "Communication via Chrome Runtime messages",
      "Test code isolated from production code"
    ]
  },
  "code_standards": {
    "style_guide": [
      "Airbnb JavaScript/TypeScript Style Guide",
      "CSS Standard Style Guide",
      "BEM Methodology",
      "TypeScript Standard Style"
    ],
    "linting_rules": [
      "ESLint with React and TypeScript plugins",
      "extends react-app",
      ".eslintrc.json with strict TypeScript rules",
      "Prohibition of any except in controlled cases",
      "Strict null checks",
      "stylelint for CSS"
    ],
    "formatting": [
      "Prettier",
      "singleQuote: true",
      "trailingComma: es5",
      "printWidth: 80",
      "arrowParens: always",
      "Indentation: 2 spaces"
    ],
    "documentation_style": [
      "JSDoc for public functions and classes",
      "Inline comments for context (in Portuguese)",
      "JSDoc for interfaces and types",
      "CSS comments for sections"
    ],
    "type_checking": [
      "Strict TypeScript",
      "TypeScript strict mode enabled",
      "NoImplicitAny enabled",
      "Explicit interfaces and types"
    ]
  },
  "testing_strategy": {
    "test_framework": [
      "Jest 29.x",
      "Playwright 1.x",
      "Cypress 12.x",
      "React Testing Library",
      "@testing-library/react 14"
    ],
    "test_structure": [
      "tests/unit/",
      "tests/integration/",
      "__tests__ folders near modules",
      "tests/components for React components",
      "tests/hooks for custom hooks"
    ],
    "coverage_requirements": [
      "Minimum 80% coverage",
      ">= 80% for critical modules",
      ">= 90% for core logic"
    ],
    "test_patterns": [
      "AAA (Arrange-Act-Assert)",
      "Given-When-Then for integration tests",
      "Snapshot testing for UI",
      "Mocks for browser APIs",
      "Behavior Driven Testing"
    ],
    "mocking_approach": [
      "jest.mock for modules",
      "Fixtures for input data",
      "Mocks for Chrome APIs",
      "Mocks for external services",
      "Manual mocks for browser APIs"
    ]
  },
  "development_workflow": {
    "branch_strategy": [
      "GitHub Flow with feature and main branches",
      "git Flow for features, releases, and hotfixes"
    ],
    "commit_conventions": ["Conventional Commits for semantic versioning"],
    "pr_requirements": [
      "Code review mandatory",
      "CI checks",
      "Passing tests required",
      "Lint and build checks"
    ],
    "ci_cd_pipeline": [
      "Linting",
      "Testing",
      "Build",
      "Deploy",
      "Automated via GitHub Actions",
      "Deploy to Chrome Web Store and Firefox Add-ons Marketplace"
    ]
  },
  "commands": {
    "setup": [
      "npm install",
      "yarn install",
      "git clone <repo-url> && cd <project-folder> && npm install"
    ],
    "install": ["npm install", "yarn install", "npm ci"],
    "dev": [
      "npm run dev",
      "yarn start",
      "yarn run start-chrome",
      "yarn run start-ff",
      "webpack-dev-server with HMR"
    ],
    "test": [
      "npm test",
      "yarn test",
      "npx jest --verbose",
      "npx cypress open",
      "npx playwright test"
    ],
    "build": [
      "npm run build",
      "yarn build",
      "yarn run build-chrome",
      "yarn run build-ff",
      "webpack --mode production"
    ],
    "lint": ["npm run lint", "yarn lint", "eslint src/ --ext .ts,.tsx"],
    "format": ["npm run format", "yarn format", "prettier --write src/"]
  },
  "security_constraints": {
    "authentication_method": [
      "OAuth2 for DeploySentinel Webapp integration",
      "Chrome Extension permissions",
      "No direct authentication for local extension",
      "Token-based Authentication (JWT) for external APIs"
    ],
    "authorization_rules": [
      "Explicit permissions in manifest for tabs, scripting, and storage",
      "Session-based access control for replay commands",
      "Role-based access for recording and viewing",
      "Validation of message origin",
      "Confirmation required for destructive actions"
    ],
    "sensitive_data": [
      "User navigation data handled locally",
      "URLs and session data stored locally",
      "Password inputs are masked",
      "No sensitive data stored or transmitted externally",
      "Session IDs and recording IDs treated as sensitive"
    ],
    "security_headers": [
      "Content Security Policy via manifest",
      "Default Chrome Extension security headers",
      "X-Frame-Options",
      "Strict-Transport-Security"
    ],
    "encryption_requirements": [
      "TLS for web communication",
      "No additional encryption for local storage",
      "Chrome storage local is not encrypted by default",
      "Sensitive data should be transmitted via HTTPS"
    ]
  },
  "performance_requirements": {
    "response_time_limits": [
      "Real-time script generation during user interaction",
      "Recording and script generation with minimal latency",
      "UI updates with <100ms latency",
      "Storage operations should complete in <500ms",
      "Instant rendering for small to medium code blocks",
      "Debounce of 200ms for storage writes",
      "Replay actions processed in real time",
      "Screenshot capture throttled to minimum 100ms intervals"
    ],
    "optimization_priorities": [
      "Developer experience",
      "Fast refresh",
      "Build speed",
      "Bundle size",
      "Low latency in event capture",
      "Efficient memory usage for local storage",
      "UI responsiveness",
      "Rendering performance for large action lists",
      "Consistent dark mode application",
      "Minimize re-renders and repaints"
    ],
    "caching_strategy": [
      "chrome.storage.local for persistent local cache",
      "Webpack cache for build optimization",
      "In-memory cache for session data",
      "Pruning strategy for screenshots and logs",
      "No explicit cache for screenshots"
    ],
    "scalability_considerations": [
      "Support for long recordings without perceptible degradation",
      "Componentization for multiple simultaneous sessions",
      "Pruning to maintain storage limits",
      "Virtual scrolling for large log lists",
      "Support for multiple tabs and frames",
      "Modular architecture for horizontal scalability"
    ]
  },
  "error_handling": {
    "error_format": [
      "Standardized JSON error objects with message and code",
      "Console.error with clear messages and stack traces",
      "UI error states with icons and descriptive text",
      "Error strings prefixed with 'error:' for screenshots",
      "Confirmation dialogs for destructive actions"
    ],
    "logging_strategy": [
      "Console logs for critical events and errors",
      "Structured logs for debugging and auditing",
      "Real-time execution logs in UI",
      "Error logs for failed storage or parsing operations"
    ],
    "monitoring_tools": [
      "GitHub Actions for build and test monitoring",
      "Sentry for error tracking",
      "Chrome Extension internal logs",
      "Custom analytics for user events"
    ],
    "error_recovery": [
      "Automatic retry on build failures",
      "Fallbacks for failed storage operations",
      "Retry for selector failures with limit",
      "Debounce to avoid excessive writes",
      "Confirmation before deletion",
      "Fallback to default configuration on load failure",
      "Pruning to avoid storage quota overflow",
      "Error highlighting and retry options in UI"
    ]
  },
  "dependencies_context": {
    "critical_dependencies": [
      "React 18.x",
      "TypeScript 5.x",
      "Webpack 5",
      "Babel",
      "Node.js 18",
      "Cypress 12.x",
      "Playwright 1.x",
      "Jest 29.x",
      "Chrome Extensions API",
      "Lodash 4.x",
      "FontAwesome 6.x",
      "chrome.storage.local",
      "RecordingService",
      "ReplayEngine singleton"
    ],
    "deprecated_packages": [
      "chrome.tabs.executeScript (deprecated, replaced by chrome.scripting)",
      "Manifest Version 2 (deprecated, migration to V3 required)"
    ],
    "version_constraints": [
      "React >=18.0.0 <19.0.0",
      "TypeScript >=5.0 <6.0",
      "Chrome Extensions Manifest V3",
      "Cypress >=12",
      "Jest >=29.0.0",
      "Node.js >=18"
    ],
    "internal_packages": [
      "src/builders",
      "src/types",
      "src/store",
      "src/replay",
      "src/services",
      "src/components",
      "src/hooks",
      "src/utils"
    ]
  },
  "current_challenges": {
    "technical_debt": [
      "Partial migration to Manifest V3 for Firefox in progress",
      "Legacy fields url and firstUrl pending full migration to urlOriginal",
      "Manual pruning and storage quota management",
      "Limited error handling in some async flows",
      "Need for improved modularization for isolated unit testing",
      "Pending refactor to unify screenshot action classes",
      "Lack of pagination for large execution volumes",
      "Improvement needed for accessibility-focused styles",
      "Pending documentation for advanced hooks and logs"
    ],
    "known_issues": [
      "Potential incompatibility of react-hot-loader with React 18+",
      "Partial compatibility with older browsers",
      "Limitations in event capture for iframes and non-main frames",
      "Storage quota limits may cause data loss without pruning",
      "Scrollbar customization limited to WebKit browsers",
      "Possible delay in state synchronization with slow storage",
      "No visual pagination implemented despite pageSize prop"
    ],
    "performance_bottlenecks": [
      "Builds may be slow on resource-limited machines",
      "Latency in local storage for very long recordings",
      "Rendering large lists without virtual scrolling would cause slowness",
      "Frequent state updates in rapid actions may impact performance",
      "Screenshot base64 memory overhead in long sessions"
    ],
    "migration_status": [
      "Migration to Manifest V3 completed for Chrome",
      "Migration to Manifest V3 for Firefox in progress",
      "Migration to urlOriginal and executionLogs partially implemented",
      "Project stable in production, no active migrations"
    ]
  },
  "team_preferences": {
    "code_review_focus": [
      "Preserve hot reload functionality",
      "Code style consistency",
      "Performance and maintainability",
      "Test coverage for critical flows",
      "Strong typing and async/await usage",
      "Security in permission usage",
      "Clear separation of responsibilities",
      "Consistent state and synchronization",
      "Accessibility and usability",
      "Consistent error handling and feedback"
    ],
    "documentation_requirements": [
      "Clear documentation for internal APIs and extension usage",
      "JSDoc for public functions and components",
      "Inline comments for complex logic",
      "Documentation for configuration and environment setup",
      "Clear documentation for hooks and advanced flows"
    ],
    "communication_style": [
      "Clear and concise comments in Portuguese",
      "Technical terms in English for precision",
      "Objective and explanatory comments",
      "Detailed PR descriptions with context",
      "Objective and technical comments, no unnecessary jargon"
    ],
    "decision_log": [
      "Adopted React 18 and TypeScript 5 for robustness",
      "Maintained Manifest V2 compatibility until full V3 migration",
      "Singleton pattern for ReplayEngine",
      "Separation between recording and replay logic",
      "Cypress as default test framework",
      "First captured URL as unique reference for recording",
      "Debounce for storage writes",
      "Pruning for storage quota management",
      "Dark mode unified via CSS variables",
      "Virtual scrolling for performance",
      "URL hash for navigation state",
      "Base64 for image portability",
      "Confirmation dialogs for destructive actions"
    ]
  },
  "api_specifications": {
    "api_style": [
      "Event-driven via Chrome Runtime Messaging API",
      "REST for DeploySentinel integration",
      "No external API exposed directly"
    ],
    "versioning_strategy": [
      "Semantic versioning via npm",
      "Manifest versioning (V2/V3)",
      "Internal migrationVersion in storage"
    ],
    "response_formats": [
      "JSON",
      "Standardized JSON for import/export",
      "Promises resolving to typed objects or null",
      "Error strings prefixed with 'error:' for screenshots"
    ],
    "rate_limiting": [
      "Debounce for event and storage writes",
      "No explicit rate limiting for internal messages",
      "Rate limiting applied by DeploySentinel external service"
    ]
  },
  "deployment_context": {
    "environments": [
      "development",
      "staging",
      "production",
      "localhost",
      "Chrome Web Store",
      "Firefox Add-ons Marketplace"
    ],
    "deployment_method": [
      "CI/CD pipelines",
      "Chrome Web Store",
      "Firefox Add-ons Marketplace",
      "Webpack bundling",
      "Docker (for backend services)"
    ],
    "environment_variables": [
      "NODE_ENV",
      "MANIFEST_VERSION",
      "CHROME_EXTENSION_ID",
      "DEPLOYSENTINEL_API_KEY",
      "PORT",
      "API_URL"
    ],
    "infrastructure_constraints": [
      "Chrome Extension API limitations",
      "Manifest V3 requirements",
      "Storage quota limits (~5MB)",
      "Browser permission restrictions",
      "Execution limited to Chrome and compatible browsers",
      "No backend for extension logic",
      "Memory limits for frontend containers"
    ]
  },
  "lastCommitHash": "eee9e3a7aac1ed66d0da8b0cdb85fcb85d8c35b2"
}
